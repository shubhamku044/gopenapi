# Sample API

A sample API to demonstrate GopenAPI generator

**Generated by [gopenapi](https://github.com/shubhamku044/gopenapi)**

## ðŸ—ï¸ Project Structure

This project uses a **clean separation** between generated and user code:

```
example/
â”œâ”€â”€ main.go              # Your application entry point (never overwritten)
â”œâ”€â”€ go.mod              # Your go.mod file (never overwritten)
â”œâ”€â”€ handlers/           # ðŸ‘ˆ YOUR CODE GOES HERE
â”‚   â””â”€â”€ api.go         # Implement your business logic here
â”œâ”€â”€ generated/          # ðŸ¤– Generated code (safe to regenerate)
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ interfaces.go  # API interface definitions
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ models.go      # Data models from OpenAPI spec
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ router.go      # HTTP server and routing
â””â”€â”€ README.md           # This file
```

## ðŸš€ Getting Started

### 1. Implement Your Business Logic

Edit `handlers/api.go` to implement your API endpoints:

```go
package handlers

import (
    "net/http"
    "github.com/gin-gonic/gin"
    "example/generated/api"
    "example/generated/models"
)

type APIHandlers struct {
    // Add your dependencies here:
    // db     *sql.DB
    // logger *slog.Logger
    // cache  redis.Client
}

func NewAPIHandlers() api.APIHandlers {
    return &APIHandlers{
        // Initialize your dependencies here
    }
}


// CreateUser Create a new user
func (h *APIHandlers) CreateUser(c *gin.Context) {
    // TODO: Implement your business logic here
    var request models.SomeModel
    if err := c.ShouldBindJSON(&request); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
        return
    }
    
    // Process the request...
    
    c.JSON(http.StatusCreated, request)
}


// ListUsers List all users
func (h *APIHandlers) ListUsers(c *gin.Context) {
    // TODO: Implement your business logic here
    c.JSON(http.StatusOK, gin.H{
        "data": []interface{}{}, // Return your data here
    })
}


// GetUser Get user by ID
func (h *APIHandlers) GetUser(c *gin.Context, id string) {
    // TODO: Implement your business logic here
    // Use path parameter: id
    c.JSON(http.StatusOK, gin.H{
        "id": id,
        "data": "your data here",
    })
}


// Ping Ping endpoint
func (h *APIHandlers) Ping(c *gin.Context) {
    // TODO: Implement your business logic here
    c.JSON(http.StatusOK, gin.H{
        "data": []interface{}{}, // Return your data here
    })
}


// Error Error endpoint
func (h *APIHandlers) Error(c *gin.Context) {
    // TODO: Implement your business logic here
    c.JSON(http.StatusOK, gin.H{
        "data": []interface{}{}, // Return your data here
    })
}


// Health health endpoint
func (h *APIHandlers) Health(c *gin.Context) {
    // TODO: Implement your business logic here
    c.JSON(http.StatusOK, gin.H{
        "data": []interface{}{}, // Return your data here
    })
}


```

### 2. Run Your Server

```bash
go mod tidy
go run main.go
```

The server will start on port 8080 (or the port specified in the `PORT` environment variable).

### 3. Test Your API


**POST /users** - Create a new user
```bash
curl -X POST http://localhost:8080/users \
  -H "Content-Type: application/json" \
  -d '{}'
```


**GET /users** - List all users
```bash
curl -X GET http://localhost:8080/users
```


**GET /users/{id}** - Get user by ID
```bash
curl -X GET http://localhost:8080/users/{id}
```


**GET /ping** - Ping endpoint
```bash
curl -X GET http://localhost:8080/ping
```


**GET /error** - Error endpoint
```bash
curl -X GET http://localhost:8080/error
```


**GET /health** - health endpoint
```bash
curl -X GET http://localhost:8080/health
```



## ðŸ”„ Updating Your API

When you modify your OpenAPI specification:

1. **Regenerate the code:**
   ```bash
   gopenapi --spec=your-api.yaml --output=. --package=example
   ```

2. **Your code is preserved:**
   - âœ… `main.go` - Your custom main function
   - âœ… `handlers/` - Your business logic implementation
   - âœ… `go.mod` - Your dependencies

3. **Generated code is updated:**
   - ðŸ”„ `generated/api/interfaces.go` - Updated interface definitions
   - ðŸ”„ `generated/models/models.go` - Updated data models  
   - ðŸ”„ `generated/server/router.go` - Updated routing

## ðŸ“š API Reference


### POST /users

**Create a new user**

Creates a new user in the system



**Request Body:**
```json
{"key": "value"}
```


**Response:**
```json
{"message": "success"}
```

---


### GET /users

**List all users**

Returns a list of users





**Response:**
```json
{"message": "success"}
```

---


### GET /users/{id}

**Get user by ID**

Returns a single user by ID

**Path Parameters:**

- `id` (string) - User ID





**Response:**
```json
{"message": "success"}
```

---


### GET /ping

**Ping endpoint**







**Response:**
```json
{"message": "success"}
```

---


### GET /error

**Error endpoint**







**Response:**
```json
{"message": "success"}
```

---


### GET /health

**health endpoint**







**Response:**
```json
{"message": "success"}
```

---



## ðŸ› ï¸ Development Tips

### Adding Middleware

Modify `main.go` to add middleware:

```go
func main() {
    apiHandlers := handlers.NewAPIHandlers()
    srv := server.NewServer(apiHandlers)
    
    // Add middleware to the router
    router := srv.GetRouter()
    router.Use(gin.Logger())
    router.Use(gin.Recovery())
    // Add your custom middleware here
    
    srv.Start(":8080")
}
```

### Error Handling

Use consistent error responses:

```go
func (h *APIHandlers) SomeHandler(c *gin.Context) {
    if err := someOperation(); err != nil {
        c.JSON(http.StatusInternalServerError, gin.H{
            "error": "Internal server error",
            "message": err.Error(),
        })
        return
    }
    
    c.JSON(http.StatusOK, gin.H{"message": "Success"})
}
```

### Database Integration

Add database dependency in `handlers/api.go`:

```go
type APIHandlers struct {
    db *sql.DB
}

func NewAPIHandlers(db *sql.DB) api.APIHandlers {
    return &APIHandlers{db: db}
}
```

## ðŸ“– Generated Models


### User

```go
type User struct {
    Email string `json:"email"`
    CreatedAt time.Time `json:"created_at"`
    Id string `json:"id"`
    Name string `json:"name"`
}
```



---

**Happy coding! ðŸŽ‰**

> This README was generated automatically. To customize it, edit the template in your gopenapi generator.
